<?php
class EMioloException extends Exception
{
    public $goTo;
    protected $manager;

    public function __construct()
    {
        global $MIOLO;

        $this->manager = $MIOLO;
        $this->goTo = $this->manager->history->Back('action'); 
    }

    public function Log()
    {
        $this->manager->LogError($this->message);
    }
}

class EInOutException extends EMioloException
{
}

class EDatabaseException extends EMioloException
{
    public function __construct($db, $msg)
    {
        parent::__construct();
        $this->message = "Error in Database: $db; " . $msg;
        $this->Log();
    }
}

class EDatabaseExecException extends EMioloException
{
    public function __construct($msg)
    {
        parent::__construct();
        $this->message = $msg;
    }
}

class EDatabaseQueryException extends EMioloException
{
    public function __construct($msg)
    {
        parent::__construct();
        $this->message = $msg;
    }
}

class EDataNotFoundException extends EMioloException
{
    public function __construct($msg)
    {
        parent::__construct();
        $this->message = "No Data Found!" . ($msg ? $msg : '');
    }
}

class EDatabaseTransactionException extends EMioloException
{
    public function __construct($msg)
    {
        parent::__construct();
        $this->message = $msg;
    }
}

class EControlException extends EMioloException
{
    public function __construct($msg)
    {
        parent::__construct();
        $this->message = $msg;
    }
}

class EUsesException extends EInOutException
{
    public function __construct($fileName)
    {
        parent::__construct();
        $this->message = "File not found by Uses: " . $fileName;
        $this->Log();
    }
}

class EFileNotFoundException extends EInOutException
{
    public function __construct($fileName, $msg = '')
    {
        parent::__construct();
        $this->message = $msg . " File not found: " . $fileName;
        $this->Log();
    }
}

class ESessionException extends EMioloException
{
    public function __construct($op)
    {
        parent::__construct();
        $this->message = "Error in Session: " . $op;
        $this->Log();
    }
}

class EBusinessException extends EMioloException
{
     public function __construct($msg)
     {
         parent::__construct();
         $this->message = _M("Error in GetBusiness: ") . $msg;
         $this->Log();
     }
}

class ETimeOutException extends EMioloException
{
     public function __construct($msg='')
     {
         parent::__construct();
         $this->message = _M("Sessão encerrada por timeout.") . $msg;
 	 $this->goTo = $this->manager->getActionURL($this->manager->GetConf('login.module'),'main');
         $this->Log();
     }
}

class ELoginException extends EMioloException
{
     public function __construct($msg='')
     {
         parent::__construct();
         $this->message = _M($msg);
         $this->goTo = $this->manager->getActionURL($this->manager->GetConf('login.module'),'main'); 
         $this->Log();
     }
}

class ESecurityException extends EMioloException
{
    public function __construct($msg)
    {
        parent::__construct();
        $this->message = $msg;
    }
}

/**
 * Excessão para Marc (Biblioteca)
 * @author Daniel Bonfim
 *
 */
class EMarcException extends EMioloException
{
    public function __construct($msg)
    {
        parent::__construct();
        $this->message = $msg;
    }
}

?>
