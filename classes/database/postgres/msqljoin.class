<?
/**
 * Brief Class Description.
 * Complete Class Description.
 */
class PostgresSqlJoin extends MSqlJoin
{

    /**
     * Brief Description.
     * Complete Description.
     *
     * @param $sql (tipo) desc
     *
     * @returns (tipo) desc
     *
     */
    function _sqlJoin($sql)
    {
        $cont = '';
        $sequence = $sql->join;
        $comparation = array();
        foreach ($sequence as $join)
        {
            if (isset($comparation[$join[1]]))
                $comparation[$join[1]] .= " AND ({$join[2]})";
            else
                $comparation[$join[1]] = "({$join[2]})";
        }
        foreach ($sql->join as $join)
        {
            if (!isset($comparation[$join[1]]))
                continue;
            if ($cond != '')
            {
                $cond = "($cond " . $join[3] . " JOIN $join[1] ON ({$comparation[$join[1]]}))";
            }
            else
            {
                $cond = "($join[0] " . $join[3] . " JOIN $join[1] ON ({$comparation[$join[1]]}))";
            }
            unset($comparation[$join[1]]);
        }
        $sql->SetTables($cond);
    }

}
?>
