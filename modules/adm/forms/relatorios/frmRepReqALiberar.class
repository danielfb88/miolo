
<?php
/* Copyright 2006, 2007, 2008, 2009, 2010 do SETEC/MEC
 *
 * Este arquivo é parte do programa SigaEPT
 *
 * O SigaEPT é um software livre;  você pode redistribuí-lo e/ou modificá-lo dentro dos
 * termos da Licença Pública Geral GNU como publicada pela fundação do software livre (FSF);
 * na versão 2 da Licença.
 *
 * Este programa é distribuído na esperança que possa ser útil, mas SEM NENHUMA GARANTIA; sem
 * uma garantia implícita de ADEQUAÇÃO a qualquer MERCADO ou APLICAÇÃO EM PARTICULAR. Veja Licença
 * Pública Geral GNU/GPL em português para maiores detalhes.
 *
 * Você deve ter recebido uma cópia da Licença Pública Geral GNU, sob o título “LICENCA.txt”,
 * junto com este programa, se não, acesse o portal do Software Público Brasileiro no endereço
 * www.softwarepublico.gov.br ou escreva para Fundação do Software Livre (FSF) Inc.,51 Franklin
 * St, Fifth Floor, Boston, MA 02110-1301, USA
 */
?>

<?
class frmRepReqALiberar extends MForm
{
	var $timestamp;

	function __construct()
    	{ 
        	parent::__construct('Relatório das Requisições a serem liberadas');
        	$this->EventHandler();
		$this->defaultButton = false;
    	}


	function CreateFields()
    	{
		global $MIOLO, $module, $action, $item, $theme;
		$fields = array(
			new MButton('btnPost','Gerar Relatório','PDF'),
			new MSeparator(),
		);
		$this->SetFields($fields);
	}


	function btnPost_click()
    	{
    		global $MIOLO, $module, $item;
		/*global $MIOLO;
       		$report = new MezPDFReport($paper = 'a4', $orientation = 'landscape'); 

	        $this->timestamp = date('d/m/Y');

	    	$requisicoes = $MIOLO->GetBusiness('adm','itemveiculo');
	       	$query = $requisicoes->ASeremLiberadas();
		
       		$options['textCol'] = array(0,0,0); 
        	$options['shaded'] = 1; 
       		$options['fontSize'] = 10; 
        	$options['titleFontSize'] = 14; 
        	$options['width'] = 800; 


        	$cols = array('Nº','Requisição','Data Requisição', 'Requisitante','Data de saída', 'Origem', 'Destino', 'Data de retorno','Tipo Veiculo');

		$num = 1;$x=0;
		while ($query->result[$x][0] <> NULL)
		{
			$query->result[$x][0] = $num;			
			$num = $num + 1;  
			$x = $x + 1;
		}

       		$report->setFont('arial.afm'); 
		$report->pdf->ezText(' '); 
		$report->pdf->ezText(' ');
		$report->pdf->ezText('<b>IFF - Instituto Federal Fluminense</b>',13); 
		$report->pdf->ezText('<b>Relatorio de Requisicoes de Veiculos a serem liberadas</b>',13); 
		$report->pdf->ezText('Campos dos Goytacazes, '.$this->timestamp);
		$report->pdf->ezText(' ');
		$report->pdf->ezTable($query->result,$cols,' ',$options); 

       		$report->execute();*/
    	$report = new MJasperReport('sigaept');

       	$parameters['SUBREPORT_DIR']	= $MIOLO->GetConf('home.modules');
       	$parameters['int_pIdUsuario']	= $MIOLO->login->idkey;
       	$parameters['pURL']		= $MIOLO->GetConf('home.url');

             

       	$report->Execute('adm', 'RequisicoesVeiculosASeremLiberadas', $parameters);
	}
}
?>
